<div class="container leadership-style" data-hj-masked>
    <div class="account-menu">
        <a class="dashboard pull-right" href="/logout"><i class="fa fa-sign-out"></i> Sign Out</a>
    </div>
    <!-- Leadership Style request message -->
    <div ng-class="{'slide-up-active': hideRequestMessage}" class="alert alert-success slide-up" role="alert" ng-show="successRequestMessage">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <i class="fa fa-paper-plane sent-icon"></i>
        <h2 class="alert-title">Invitation<span ng-show="successRequestMessageRecipient.length>1">s</span> Sent!</h2>
        <p class="alert-message">
            <span ng-show="successRequestMessageRecipient.length>1">Invitations have been sent to</span>
            <span ng-show="successRequestMessageRecipient.length==1">An invitation has been sent to</span>
            <span ng-repeat="invitee in successRequestMessageRecipient"><span ng-show="$last && successRequestMessageRecipient.length > 1"> and </span>{{ invitee.email }}<span ng-show="!($last) && successRequestMessageRecipient.length > 2">, </span></span>.
        </p>
    </div>

    <div ng-show="index.showTakeQuizNotification" ng-class="{'slide-up-active': hideMessage}" class="alert alert-success slide-up" role="alert">
        <a class="btn btn-success btn-feedback pull-right" ng-click="index.takeQuiz(index.myLeadershipStyle)" type="button">
            <i class="fa fa-comment"></i>
            <span ng-if="index.myLeadershipStyle.answers.length>0" class="hide-for-mobile">Finish the </span>
            Quiz
        </a>
        <h2 class="alert-title">Take the Quiz!</h2>
        <div class="alert-message" style="padding-left:0; padding-top: 10px">
            <div>
                <div class="comment-text">
                    You have a natural leadership style. With your own strengths and weaknesses. Discover who you are and how to unlock your best self.
                </div>
            </div>
        </div>
    </div>

    <div class="panel fade-in" ng-if="index.myLeadershipStyle.scores.length > 0 && index.myLeadershipStyle.teams.length==0" >
        <h3 class="modal-title panel-title">Your Results</h3>

        <div ng-bind-html="index.myLeadershipStyle.description.description"></div>
        <div class="leadership-style-scores">
            <div class="well">
            <div class="call-to-action" ng-if="index.myLeadershipStyle.teams.length==0">
                <h3 class="title">[ACTION REQUESTED] Now, come take the next step &#8230;</h3>
                <p class="message">
You have <em>your</em> score. Now, invite up to eight team members to take this quiz&#8212;and get a <span style="text-decoration: underline">personalized</span> report from our experts to help you and your team become more self-aware, more collaborative, and more powerful. Understand how your team's complementary skills can be best unleashed, all for a nominal fee. (Each report will be personalized based on <span style="text-decoration: underline">your</span> team, after all!) To learn more or get started, simply click the button below to get started:</p>
                
                <form action="/account/payment" method="POST" id="paymentForm">
                <input type="hidden" name="csrfmiddlewaretoken" ng-value="index.myLeadershipStyle.csrf_token">
                
                <button class="btn btn-success btn-block" id="stripePay" style="margin-bottom: 15px;" type="submit">Get Started for just $199</button>
                <input type="hidden" id="stripeToken" name="stripeToken" value="" />
                <input type="hidden" id="stripeEmail" name="stripeEmail" value="" />
                </form>

                <script>
                    $(function () {
                        var handler = StripeCheckout.configure({
                            key: '{{index.myLeadershipStyle.stripe_key}}',
                            locale: 'auto',
                            token: function(token) {
                                var $stripeToken = $('#stripeToken');
                                var $stripeEmail = $('#stripeEmail');

                                $stripeToken.val(token.id);
                                $stripeEmail.val(token.email);

                                var $paymentForm = $('#paymentForm');
                                $paymentForm.submit();
                            }
                        });

                        document.getElementById('stripePay').addEventListener('click', function(e) {
                            // Open Checkout with further options:
                            handler.open({
                                name: 'The Motley Fool LLC',
                                description: 'Predictable Success for $199',
                                amount: 19900
                            });

                            e.preventDefault();
                        });

                        // Close Checkout on page navigation:
                        window.addEventListener('popstate', function() {
                            handler.close();
                        });
                    });
                </script>
            </div>
            </div>

        </div>

    </div>
    <div ng-repeat="team in index.myLeadershipStyle.teams | orderBy:'customer_id'">
        <div ng-if="team.owner.id==index.myLeadershipStyle.employee.id">
            <div class="panel fade-in" ng-if="!team.requested_report">
                <h3 class="modal-title">Get YOUR Team Report</h3>
                <p>Your invitations have been. You can see their progress below.  When the members of your team have completed the quiz, or you are ready to send your teamâ€™s data along for your one-time, customized report, click the button below.</p>
                <button ng-disabled="!team.can_request_report" ng-click="index.requestTeamReport(team.id, $index)" class="btn btn-success" style="margin-top: 10px;width:100%" type="submit">Get YOUR Team Report</button>
                <p class="centered" style="color: #aaa;" ng-if="!team.can_request_report">Before we can generate YOUR Team Report at least 6 of your Team Members need to complete their Leadership Style quiz.</p>
            </div>
            <div class="panel fade-in" ng-if="team.requested_report && !team.received_report">
                <h3 class="modal-title">Your Team Report</h3>
                <p>We are working on your team report. Please allow 3-5 business days.
            </div>
            <div class="invite-360" style="height: 25px;">
                <h4 ng-if="index.myLeadershipStyle.teams.length > 0" class="header"><a href="" class="pull-right" ng-click="index.invite(team.id)">+ Invite more team members</a></h4>
            </div>
        </div>
        <div class="panel fade-in" ng-if="$first && index.myLeadershipStyle.scores.length" ng-init="collapse=true">
            <div style="min-height: 55px;">
                <div class="avatar-container col-xs-1" style="margin-right: 25px">
                    <employee-avatar size="large" employee="index.myLeadershipStyle.employee"></employee-avatar>
                </div>
                <h3 class="modal-title">You
                    <i class="fa fa-chevron-down pull-right collapse-toggle" ng-show="!collapse" ng-click="collapse=!collapse"></i>
                    <i class="fa fa-chevron-right pull-right collapse-toggle" ng-show="collapse" ng-click="collapse=!collapse"></i>
                </h3>
                <h3 class="modal-title">
                    <span ng-repeat="score in index.myLeadershipStyle.scores | orderBy : 'score' : true">
                        <span class="sub-title {{ score.style_verbose }}" ng-if="$first">{{score.style_verbose}} - {{score.score}},</span>
                        <span class="sub-title" ng-if="!$first && !$last">{{score.style_verbose}} - {{score.score}},</span>
                        <span class="sub-title" ng-if="$last">{{score.style_verbose}} - {{score.score}}</span>
                    </span>
                </h3>
            </div>
            <div collapse="collapse" style="padding-top: 8px;">
                <div ng-bind-html="index.myLeadershipStyle.description.description"></div>
            </div>
        </div>

        <div class="panel fade-in" ng-repeat="team_member in team.team_members  | orderBy:'full_name'" ng-if="team_member.leadership_style.id != index.myLeadershipStyle.id" ng-init="team_member.collapse=true">
            <div style="min-height: 55px;">
                <div class="avatar-container col-xs-1" style="margin-right: 25px">
                    <employee-avatar size="large" employee="team_member"></employee-avatar>
                </div>
                <h3 class="modal-title">
                    {{ team_member.full_name }}
                    <span ng-if="team_member.leadership_style && team_member.leadership_style.completed">
                        <i class="fa fa-chevron-down pull-right collapse-toggle" ng-show="!team_member.collapse" ng-click="team_member.collapse=!team_member.collapse"></i>
                        <i class="fa fa-chevron-right pull-right collapse-toggle" ng-show="team_member.collapse" ng-click="team_member.collapse=!team_member.collapse"></i>
                    </span>
                </h3>
                <div ng-if="!team_member.leadership_style || !team_member.leadership_style.completed">
                    <h3 class="modal-title sub-title" ng-if="!team_member.leadership_style">
                        0% Completed
                    </h3>
                    <h3 class="modal-title sub-title" ng-if="team_member.leadership_style">
                        {{ team_member.leadership_style.percentage_complete }}% Completed
                    </h3>
                </div>
                <div ng-if="team_member.leadership_style && team_member.leadership_style.completed">
                    <h3 class="modal-title">
                        <span ng-repeat="score in team_member.leadership_style.scores | orderBy : 'score' : true">
                            <span class="sub-title {{ score.style_verbose }}" ng-if="$first">{{score.style_verbose}} - {{score.score}},</span>
                            <span class="sub-title" ng-if="!$first && !$last">{{score.style_verbose}} - {{score.score}},</span>
                            <span class="sub-title" ng-if="$last">{{score.style_verbose}} - {{score.score}}</span>
                        </span>
                    </h3>
                </div>
            </div>
            <div collapse="team_member.collapse" ng-if="team_member.leadership_style && team_member.leadership_style.completed" style="padding-top: 8px;">
                <div ng-bind-html="team_member.leadership_style.description.description"></div>
            </div>
        </div>
    </div>
</div>