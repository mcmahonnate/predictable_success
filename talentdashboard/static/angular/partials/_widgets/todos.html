<div class="panel todos" ng-if="currentUser.can_view_comments">
    <h2 class="panel-title">To Do's</h2> 
    <ul class="nav nav-tabs">
        <li role="presentation" ng-class="{'active': activeTab == todoTab}"><a ng-click="setActiveTab(todoTab)">To Do</a></li>
        <li role="presentation" ng-class="{'active': activeTab == doneTab}"><a ng-click="setActiveTab(doneTab)">Done</a></li>
    </ul>
    <div ng-show="activeTab == todoTab">
        <div ng-show="todos.length === 0" class="todos-empty">
            <p>You currently don't have any tasks. Add Todos on employee profile pages.</p>
        </div>
        <div ng-if="todos.length > 0">
            <div class="row shaded">
                <div class="col-md-3 col-lg-2"></div>
                <div class="col-md-4 col-lg-5">Tasks</div>
                <div class="col-xs-3">Assigned To</div>
                <div class="col-xs-2">Due Date</div>
            </div>    
            <div class="row todo" ng-repeat="task in todos">
                <div class="col-xs-2">
                    <button ng-click="editTask(task)">Edit</button>
                    <button ng-click="deleteTask(task)">Delete</button>
                    <button ng-click="toggleCompleted(task)">Toggle Completed</button>
                    <a ng-href="/#/employees/{{task.employee.id}}">
                        <img alt="{{task.employee.full_name}}" title="{{task.employee.full_name}}" ng-src="{{ task.employee.avatar_small }}" class="small-headshot" />
                    </a>
                </div>
                <div class="col-xs-5 todo-description-container">     
                    <div ng-class="{'todo-completed': task.completed}">
                        <p><strong><a ng-href="/#/employees/{{task.employee.id}}">{{task.employee.full_name}}</a></strong> <span class="timestamp">{{ task.created_date | fromNow }}</span></p>
                        <p class="todo-description">{{task.description}}</p>
                    </div>
                </div>  
                <div class="col-xs-3">  
                    {{task.assigned_to.full_name||"Unassigned"}}
                </div>
                <div class="col-xs-2 date">    
                    {{(task.due_date | date:'MMM d') || "None"}}
                </div>
            </div>
        </div>        
    </div>
    <div ng-show="activeTab == doneTab">
        <div ng-show="done.length === 0" class="todos-empty">
            <p>You don't have any completed tasks.</p>
        </div>
        <div ng-if="done.length > 0">
            <div class="row shaded">
                <div class="col-md-3 col-lg-2"></div>
                <div class="col-md-4 col-lg-5">Tasks</div>
                <div class="col-xs-3">Assigned To</div>
                <div class="col-xs-2">Due Date</div>
            </div>    
            <div class="row todo" ng-repeat="task in done">
                <div class="col-xs-2">
                    <a ng-href="/#/employees/{{task.employee.id}}">
                        <img alt="{{task.employee.full_name}}" title="{{task.employee.full_name}}" ng-src="{{ task.employee.avatar_small }}" class="small-headshot" />
                    </a>
                </div>
                <div class="col-xs-5 todo-description-container">
                    <div ng-class="{'todo-completed': task.completed}">
                        <p><strong><a ng-href="/#/employees/{{task.employee.id}}">{{task.employee.full_name}}</a></strong> <span class="timestamp">{{ task.created_date | fromNow }}</span></p>
                        <p class="todo-description">{{task.description}}</p>
                    </div>
                </div>
                <div class="col-xs-3">
                    {{task.assigned_to.full_name||"Unassigned"}}
                </div>
                <div class="col-xs-2 date">
                    {{(task.due_date | date:'MMM d') || "None"}}
                </div>
            </div>
        </div>
    </div>
    <button ng-show="canAddNew" ng-click="newTask()">New Task</button>
</div>