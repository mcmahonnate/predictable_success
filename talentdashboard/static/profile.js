;(function() {
"use strict";

angular
    .module('profile', ['ngRoute', 'ui-notification']);

angular
    .module('profile')
    .controller('SummaryController', SummaryController);

function SummaryController(Employee, analytics, $location, $rootScope, $routeParams, $scope) {
    var vm = this;
    vm.employee = null;
    vm.moreInfoCollapse = true;
    vm.collapse = true;

    activate();

    function activate() {
        getEmployee();
    };

    function getEmployee() {
        Employee.get(
            {id: $routeParams.id},
            function (data) {
                vm.employee = data;
                vm.employee.hire_date = $rootScope.parseDate(vm.employee.hire_date);
            }
        );
    }
}
SummaryController.$inject = ["Employee", "analytics", "$location", "$rootScope", "$routeParams", "$scope"];
angular
    .module('profile')
    .controller('ProfileController', ProfileController);

function ProfileController(Employee, ThirdParties, analytics, $location, $rootScope, $routeParams, $scope) {
    /* Since this page can be the root for some users let's make sure we capture the correct page */
    var location_url = $location.url().indexOf('/profile') < 0 ? '/profile' : $location.url();
    analytics.trackPage($scope, $location.absUrl(), location_url);
    var vm = this;
    vm.employee = null;
    vm.moreInfoCollapse = true;
    vm.filterCommentsByType = filterCommentsByType;
    vm.filterCommentsByView = filterCommentsByView;
    vm.filterCommentsByThirdParty = filterCommentsByThirdParty;
    vm.filter = {type: null, view: 'me', third_party: null};
    vm.third_parties = [];

    activate();

    function activate() {
        resetFilter();
        getEmployee();
        getThirdParties();
    };

    function getEmployee() {
        Employee.get(
            {id: $routeParams.id},
            function (data) {
                vm.employee = data;
                vm.employee.hire_date = $rootScope.parseDate(vm.employee.hire_date);
            }
        );
    }

    function getThirdParties() {
        ThirdParties.query(
            null,
            function (data) {
                vm.third_parties = data;
            }
        )
    }

    function filterCommentsByType(type) {
        vm.filter.type = type;
        filterComments();
    }

    function filterCommentsByView(view) {
        vm.filter.view = view;
        filterComments();
    }

    function filterCommentsByThirdParty(third_party) {
        vm.filter.type = 'thirdpartyevent';
        vm.filter.third_party = third_party;
        filterComments();

    }

    function filterComments() {
        $scope.$broadcast('filterComments', vm.filter);
        resetFilter()
    }

    function resetFilter() {
        vm.filter.type = null;
        vm.filter.third_party = null;
    }

}
ProfileController.$inject = ["Employee", "ThirdParties", "analytics", "$location", "$rootScope", "$routeParams", "$scope"];
}());

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2ZpbGUubW9kdWxlLmpzIiwic3VtbWFyeS5jb250cm9sbGVyLmpzIiwicHJvZmlsZS5jb250cm9sbGVyLmpzIiwicHJvZmlsZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxDQUFBLENBQUEsV0FBQTtBQUNBOztBQ0RBO0tBQ0EsT0FBQSxXQUFBLENBQUEsV0FBQTs7QUFFQTtLQUNBLE9BQUE7S0FDQSxXQUFBLHFCQUFBOztBQUVBLFNBQUEsa0JBQUEsVUFBQSxXQUFBLFdBQUEsWUFBQSxjQUFBLFFBQUE7SUFDQSxJQUFBLEtBQUE7SUFDQSxHQUFBLFdBQUE7SUFDQSxHQUFBLG1CQUFBO0lBQ0EsR0FBQSxXQUFBOztJQUVBOztJQUVBLFNBQUEsV0FBQTtRQUNBO0tBQ0E7O0lBRUEsU0FBQSxjQUFBO1FBQ0EsU0FBQTtZQUNBLENBQUEsSUFBQSxhQUFBO1lBQ0EsVUFBQSxNQUFBO2dCQUNBLEdBQUEsV0FBQTtnQkFDQSxHQUFBLFNBQUEsWUFBQSxXQUFBLFVBQUEsR0FBQSxTQUFBOzs7Ozs7QUNyQkE7S0FDQSxPQUFBO0tBQ0EsV0FBQSxxQkFBQTs7QUFFQSxTQUFBLGtCQUFBLFVBQUEsY0FBQSxXQUFBLFdBQUEsWUFBQSxjQUFBLFFBQUE7O0lBRUEsSUFBQSxlQUFBLFVBQUEsTUFBQSxRQUFBLGNBQUEsSUFBQSxhQUFBLFVBQUE7SUFDQSxVQUFBLFVBQUEsUUFBQSxVQUFBLFVBQUE7SUFDQSxJQUFBLEtBQUE7SUFDQSxHQUFBLFdBQUE7SUFDQSxHQUFBLG1CQUFBO0lBQ0EsR0FBQSx1QkFBQTtJQUNBLEdBQUEsdUJBQUE7SUFDQSxHQUFBLDZCQUFBO0lBQ0EsR0FBQSxTQUFBLENBQUEsTUFBQSxNQUFBLE1BQUEsTUFBQSxhQUFBO0lBQ0EsR0FBQSxnQkFBQTs7SUFFQTs7SUFFQSxTQUFBLFdBQUE7UUFDQTtRQUNBO1FBQ0E7S0FDQTs7SUFFQSxTQUFBLGNBQUE7UUFDQSxTQUFBO1lBQ0EsQ0FBQSxJQUFBLGFBQUE7WUFDQSxVQUFBLE1BQUE7Z0JBQ0EsR0FBQSxXQUFBO2dCQUNBLEdBQUEsU0FBQSxZQUFBLFdBQUEsVUFBQSxHQUFBLFNBQUE7Ozs7O0lBS0EsU0FBQSxrQkFBQTtRQUNBLGFBQUE7WUFDQTtZQUNBLFVBQUEsTUFBQTtnQkFDQSxHQUFBLGdCQUFBOzs7OztJQUtBLFNBQUEscUJBQUEsTUFBQTtRQUNBLEdBQUEsT0FBQSxPQUFBO1FBQ0E7OztJQUdBLFNBQUEscUJBQUEsTUFBQTtRQUNBLEdBQUEsT0FBQSxPQUFBO1FBQ0E7OztJQUdBLFNBQUEsMkJBQUEsYUFBQTtRQUNBLEdBQUEsT0FBQSxPQUFBO1FBQ0EsR0FBQSxPQUFBLGNBQUE7UUFDQTs7OztJQUlBLFNBQUEsaUJBQUE7UUFDQSxPQUFBLFdBQUEsa0JBQUEsR0FBQTtRQUNBOzs7SUFHQSxTQUFBLGNBQUE7UUFDQSxHQUFBLE9BQUEsT0FBQTtRQUNBLEdBQUEsT0FBQSxjQUFBOzs7Ozs7QUNrQ0EiLCJmaWxlIjoicHJvZmlsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXJcbiAgICAubW9kdWxlKCdwcm9maWxlJywgWyduZ1JvdXRlJywgJ3VpLW5vdGlmaWNhdGlvbiddKTtcbiIsImFuZ3VsYXJcbiAgICAubW9kdWxlKCdwcm9maWxlJylcbiAgICAuY29udHJvbGxlcignU3VtbWFyeUNvbnRyb2xsZXInLCBTdW1tYXJ5Q29udHJvbGxlcik7XG5cbmZ1bmN0aW9uIFN1bW1hcnlDb250cm9sbGVyKEVtcGxveWVlLCBhbmFseXRpY3MsICRsb2NhdGlvbiwgJHJvb3RTY29wZSwgJHJvdXRlUGFyYW1zLCAkc2NvcGUpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmVtcGxveWVlID0gbnVsbDtcbiAgICB2bS5tb3JlSW5mb0NvbGxhcHNlID0gdHJ1ZTtcbiAgICB2bS5jb2xsYXBzZSA9IHRydWU7XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgIGdldEVtcGxveWVlKCk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGdldEVtcGxveWVlKCkge1xuICAgICAgICBFbXBsb3llZS5nZXQoXG4gICAgICAgICAgICB7aWQ6ICRyb3V0ZVBhcmFtcy5pZH0sXG4gICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLmVtcGxveWVlID0gZGF0YTtcbiAgICAgICAgICAgICAgICB2bS5lbXBsb3llZS5oaXJlX2RhdGUgPSAkcm9vdFNjb3BlLnBhcnNlRGF0ZSh2bS5lbXBsb3llZS5oaXJlX2RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cbn0iLCJhbmd1bGFyXG4gICAgLm1vZHVsZSgncHJvZmlsZScpXG4gICAgLmNvbnRyb2xsZXIoJ1Byb2ZpbGVDb250cm9sbGVyJywgUHJvZmlsZUNvbnRyb2xsZXIpO1xuXG5mdW5jdGlvbiBQcm9maWxlQ29udHJvbGxlcihFbXBsb3llZSwgVGhpcmRQYXJ0aWVzLCBhbmFseXRpY3MsICRsb2NhdGlvbiwgJHJvb3RTY29wZSwgJHJvdXRlUGFyYW1zLCAkc2NvcGUpIHtcbiAgICAvKiBTaW5jZSB0aGlzIHBhZ2UgY2FuIGJlIHRoZSByb290IGZvciBzb21lIHVzZXJzIGxldCdzIG1ha2Ugc3VyZSB3ZSBjYXB0dXJlIHRoZSBjb3JyZWN0IHBhZ2UgKi9cbiAgICB2YXIgbG9jYXRpb25fdXJsID0gJGxvY2F0aW9uLnVybCgpLmluZGV4T2YoJy9wcm9maWxlJykgPCAwID8gJy9wcm9maWxlJyA6ICRsb2NhdGlvbi51cmwoKTtcbiAgICBhbmFseXRpY3MudHJhY2tQYWdlKCRzY29wZSwgJGxvY2F0aW9uLmFic1VybCgpLCBsb2NhdGlvbl91cmwpO1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uZW1wbG95ZWUgPSBudWxsO1xuICAgIHZtLm1vcmVJbmZvQ29sbGFwc2UgPSB0cnVlO1xuICAgIHZtLmZpbHRlckNvbW1lbnRzQnlUeXBlID0gZmlsdGVyQ29tbWVudHNCeVR5cGU7XG4gICAgdm0uZmlsdGVyQ29tbWVudHNCeVZpZXcgPSBmaWx0ZXJDb21tZW50c0J5VmlldztcbiAgICB2bS5maWx0ZXJDb21tZW50c0J5VGhpcmRQYXJ0eSA9IGZpbHRlckNvbW1lbnRzQnlUaGlyZFBhcnR5O1xuICAgIHZtLmZpbHRlciA9IHt0eXBlOiBudWxsLCB2aWV3OiAnbWUnLCB0aGlyZF9wYXJ0eTogbnVsbH07XG4gICAgdm0udGhpcmRfcGFydGllcyA9IFtdO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgICByZXNldEZpbHRlcigpO1xuICAgICAgICBnZXRFbXBsb3llZSgpO1xuICAgICAgICBnZXRUaGlyZFBhcnRpZXMoKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gZ2V0RW1wbG95ZWUoKSB7XG4gICAgICAgIEVtcGxveWVlLmdldChcbiAgICAgICAgICAgIHtpZDogJHJvdXRlUGFyYW1zLmlkfSxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0uZW1wbG95ZWUgPSBkYXRhO1xuICAgICAgICAgICAgICAgIHZtLmVtcGxveWVlLmhpcmVfZGF0ZSA9ICRyb290U2NvcGUucGFyc2VEYXRlKHZtLmVtcGxveWVlLmhpcmVfZGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0VGhpcmRQYXJ0aWVzKCkge1xuICAgICAgICBUaGlyZFBhcnRpZXMucXVlcnkoXG4gICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS50aGlyZF9wYXJ0aWVzID0gZGF0YTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpbHRlckNvbW1lbnRzQnlUeXBlKHR5cGUpIHtcbiAgICAgICAgdm0uZmlsdGVyLnR5cGUgPSB0eXBlO1xuICAgICAgICBmaWx0ZXJDb21tZW50cygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpbHRlckNvbW1lbnRzQnlWaWV3KHZpZXcpIHtcbiAgICAgICAgdm0uZmlsdGVyLnZpZXcgPSB2aWV3O1xuICAgICAgICBmaWx0ZXJDb21tZW50cygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpbHRlckNvbW1lbnRzQnlUaGlyZFBhcnR5KHRoaXJkX3BhcnR5KSB7XG4gICAgICAgIHZtLmZpbHRlci50eXBlID0gJ3RoaXJkcGFydHlldmVudCc7XG4gICAgICAgIHZtLmZpbHRlci50aGlyZF9wYXJ0eSA9IHRoaXJkX3BhcnR5O1xuICAgICAgICBmaWx0ZXJDb21tZW50cygpO1xuXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmlsdGVyQ29tbWVudHMoKSB7XG4gICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCdmaWx0ZXJDb21tZW50cycsIHZtLmZpbHRlcik7XG4gICAgICAgIHJlc2V0RmlsdGVyKClcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXNldEZpbHRlcigpIHtcbiAgICAgICAgdm0uZmlsdGVyLnR5cGUgPSBudWxsO1xuICAgICAgICB2bS5maWx0ZXIudGhpcmRfcGFydHkgPSBudWxsO1xuICAgIH1cblxufSIsIjsoZnVuY3Rpb24oKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3Byb2ZpbGUnLCBbJ25nUm91dGUnLCAndWktbm90aWZpY2F0aW9uJ10pO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgncHJvZmlsZScpXG4gICAgLmNvbnRyb2xsZXIoJ1N1bW1hcnlDb250cm9sbGVyJywgU3VtbWFyeUNvbnRyb2xsZXIpO1xuXG5mdW5jdGlvbiBTdW1tYXJ5Q29udHJvbGxlcihFbXBsb3llZSwgYW5hbHl0aWNzLCAkbG9jYXRpb24sICRyb290U2NvcGUsICRyb3V0ZVBhcmFtcywgJHNjb3BlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5lbXBsb3llZSA9IG51bGw7XG4gICAgdm0ubW9yZUluZm9Db2xsYXBzZSA9IHRydWU7XG4gICAgdm0uY29sbGFwc2UgPSB0cnVlO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgICBnZXRFbXBsb3llZSgpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBnZXRFbXBsb3llZSgpIHtcbiAgICAgICAgRW1wbG95ZWUuZ2V0KFxuICAgICAgICAgICAge2lkOiAkcm91dGVQYXJhbXMuaWR9LFxuICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS5lbXBsb3llZSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgdm0uZW1wbG95ZWUuaGlyZV9kYXRlID0gJHJvb3RTY29wZS5wYXJzZURhdGUodm0uZW1wbG95ZWUuaGlyZV9kYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG59XG5hbmd1bGFyXG4gICAgLm1vZHVsZSgncHJvZmlsZScpXG4gICAgLmNvbnRyb2xsZXIoJ1Byb2ZpbGVDb250cm9sbGVyJywgUHJvZmlsZUNvbnRyb2xsZXIpO1xuXG5mdW5jdGlvbiBQcm9maWxlQ29udHJvbGxlcihFbXBsb3llZSwgVGhpcmRQYXJ0aWVzLCBhbmFseXRpY3MsICRsb2NhdGlvbiwgJHJvb3RTY29wZSwgJHJvdXRlUGFyYW1zLCAkc2NvcGUpIHtcbiAgICAvKiBTaW5jZSB0aGlzIHBhZ2UgY2FuIGJlIHRoZSByb290IGZvciBzb21lIHVzZXJzIGxldCdzIG1ha2Ugc3VyZSB3ZSBjYXB0dXJlIHRoZSBjb3JyZWN0IHBhZ2UgKi9cbiAgICB2YXIgbG9jYXRpb25fdXJsID0gJGxvY2F0aW9uLnVybCgpLmluZGV4T2YoJy9wcm9maWxlJykgPCAwID8gJy9wcm9maWxlJyA6ICRsb2NhdGlvbi51cmwoKTtcbiAgICBhbmFseXRpY3MudHJhY2tQYWdlKCRzY29wZSwgJGxvY2F0aW9uLmFic1VybCgpLCBsb2NhdGlvbl91cmwpO1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uZW1wbG95ZWUgPSBudWxsO1xuICAgIHZtLm1vcmVJbmZvQ29sbGFwc2UgPSB0cnVlO1xuICAgIHZtLmZpbHRlckNvbW1lbnRzQnlUeXBlID0gZmlsdGVyQ29tbWVudHNCeVR5cGU7XG4gICAgdm0uZmlsdGVyQ29tbWVudHNCeVZpZXcgPSBmaWx0ZXJDb21tZW50c0J5VmlldztcbiAgICB2bS5maWx0ZXJDb21tZW50c0J5VGhpcmRQYXJ0eSA9IGZpbHRlckNvbW1lbnRzQnlUaGlyZFBhcnR5O1xuICAgIHZtLmZpbHRlciA9IHt0eXBlOiBudWxsLCB2aWV3OiAnbWUnLCB0aGlyZF9wYXJ0eTogbnVsbH07XG4gICAgdm0udGhpcmRfcGFydGllcyA9IFtdO1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgICByZXNldEZpbHRlcigpO1xuICAgICAgICBnZXRFbXBsb3llZSgpO1xuICAgICAgICBnZXRUaGlyZFBhcnRpZXMoKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gZ2V0RW1wbG95ZWUoKSB7XG4gICAgICAgIEVtcGxveWVlLmdldChcbiAgICAgICAgICAgIHtpZDogJHJvdXRlUGFyYW1zLmlkfSxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0uZW1wbG95ZWUgPSBkYXRhO1xuICAgICAgICAgICAgICAgIHZtLmVtcGxveWVlLmhpcmVfZGF0ZSA9ICRyb290U2NvcGUucGFyc2VEYXRlKHZtLmVtcGxveWVlLmhpcmVfZGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0VGhpcmRQYXJ0aWVzKCkge1xuICAgICAgICBUaGlyZFBhcnRpZXMucXVlcnkoXG4gICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS50aGlyZF9wYXJ0aWVzID0gZGF0YTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpbHRlckNvbW1lbnRzQnlUeXBlKHR5cGUpIHtcbiAgICAgICAgdm0uZmlsdGVyLnR5cGUgPSB0eXBlO1xuICAgICAgICBmaWx0ZXJDb21tZW50cygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpbHRlckNvbW1lbnRzQnlWaWV3KHZpZXcpIHtcbiAgICAgICAgdm0uZmlsdGVyLnZpZXcgPSB2aWV3O1xuICAgICAgICBmaWx0ZXJDb21tZW50cygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpbHRlckNvbW1lbnRzQnlUaGlyZFBhcnR5KHRoaXJkX3BhcnR5KSB7XG4gICAgICAgIHZtLmZpbHRlci50eXBlID0gJ3RoaXJkcGFydHlldmVudCc7XG4gICAgICAgIHZtLmZpbHRlci50aGlyZF9wYXJ0eSA9IHRoaXJkX3BhcnR5O1xuICAgICAgICBmaWx0ZXJDb21tZW50cygpO1xuXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmlsdGVyQ29tbWVudHMoKSB7XG4gICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCdmaWx0ZXJDb21tZW50cycsIHZtLmZpbHRlcik7XG4gICAgICAgIHJlc2V0RmlsdGVyKClcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXNldEZpbHRlcigpIHtcbiAgICAgICAgdm0uZmlsdGVyLnR5cGUgPSBudWxsO1xuICAgICAgICB2bS5maWx0ZXIudGhpcmRfcGFydHkgPSBudWxsO1xuICAgIH1cblxufVxufSgpKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
